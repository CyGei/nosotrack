<!DOCTYPE HTML>
<html>

<head>
	<title>NosoTrack</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
	<link rel="stylesheet" href="https://unpkg.com/vis-network/styles/vis-network.css" />

	<style>
		#network-canvas {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			z-index: 0;
			pointer-events: none;
		}

		/* Ensure the wrapper sits above the canvas */
		#wrapper {
			position: relative;
			z-index: 2;
		}

		/* Ensure the background div sits behind the canvas */
		#bg {
			z-index: -1;
		}

		/* ── Process Section ── */
		#process {
			width: 56rem;
		}

		.pipeline {
			position: relative;
			width: 100%;
			overflow: hidden;
		}

		/* ── Stage container ── */
		.pipeline-stage {
			position: relative;
			margin-bottom: 0;
			opacity: 0;
			transform: translateY(24px);
			transition: opacity 0.6s ease, transform 0.6s ease;
		}
		.pipeline-stage.visible {
			opacity: 1;
			transform: translateY(0);
		}

		/* Stagger by data-stage attribute */
		.pipeline-stage[data-stage="2"] { transition-delay: 0.15s; }
		.pipeline-stage[data-stage="3"] { transition-delay: 0.3s; }
		.pipeline-stage[data-stage="4"] { transition-delay: 0.45s; }
		.pipeline-stage[data-stage="5"] { transition-delay: 0.6s; }

		/* ── Stage label ── */
		.stage-label {
			font-family: 'Courier New', monospace;
			font-size: 0.65rem;
			letter-spacing: 2px;
			color: rgba(255,255,255,0.35);
			text-transform: uppercase;
			margin-bottom: 10px;
		}

		/* ── Data Sources (Stage 1) ── */
		.data-sources {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 14px;
		}

		.source-card {
			background: rgba(255,255,255,0.03);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 8px;
			padding: 20px 14px;
			text-align: center;
			position: relative;
			overflow: hidden;
		}

		.source-card .source-icon {
			width: 36px;
			height: 36px;
			margin: 0 auto 10px;
			opacity: 0.7;
		}

		.source-card .source-icon svg {
			width: 100%;
			height: 100%;
		}

		.source-card .source-title {
			font-size: 0.8rem;
			font-weight: 600;
			letter-spacing: 0.5px;
			color: #fff;
			margin-bottom: 4px;
		}

		.source-card .source-sub {
			font-size: 0.65rem;
			color: rgba(255,255,255,0.4);
			letter-spacing: 0.3px;
		}

		/* Animated pulse ring on source cards */
		.source-card::after {
			content: '';
			position: absolute;
			inset: 0;
			border-radius: 8px;
			border: 1px solid rgba(255, 7, 58, 0);
			animation: sourcePulse 3s ease-in-out infinite;
		}
		.source-card:nth-child(2)::after { animation-delay: 1s; }
		.source-card:nth-child(3)::after { animation-delay: 2s; }

		@keyframes sourcePulse {
			0%, 100% { border-color: rgba(255, 7, 58, 0); }
			50% { border-color: rgba(255, 7, 58, 0.3); }
		}

		/* ── Flow connector (vertical lines + dots between stages) ── */
		.flow-connector {
			display: flex;
			flex-direction: column;
			align-items: center;
			height: 50px;
			position: relative;
		}

		.flow-connector .flow-lines {
			position: relative;
			width: 100%;
			height: 100%;
		}

		/* Three converging lines from sources */
		.flow-connector.converge .flow-lines::before,
		.flow-connector.converge .flow-lines::after,
		.flow-connector.converge .flow-center-line {
			content: '';
			position: absolute;
			bottom: 0;
			width: 1px;
			background: linear-gradient(to bottom, rgba(255,7,58,0), rgba(255,7,58,0.4));
		}
		.flow-connector.converge .flow-lines::before {
			left: 16.66%;
			height: 100%;
			animation: flowDown 2s ease-in-out infinite;
		}
		.flow-connector.converge .flow-center-line {
			left: 50%;
			height: 100%;
			animation: flowDown 2s ease-in-out infinite 0.3s;
		}
		.flow-connector.converge .flow-lines::after {
			right: 16.66%;
			height: 100%;
			animation: flowDown 2s ease-in-out infinite 0.6s;
		}

		/* Single center line for later stages */
		.flow-connector.single .flow-lines::before {
			content: '';
			position: absolute;
			left: 50%;
			top: 0;
			width: 1px;
			height: 100%;
			background: linear-gradient(to bottom, rgba(255,7,58,0.3), rgba(255,7,58,0.15));
			animation: flowDown 2s ease-in-out infinite;
		}

		@keyframes flowDown {
			0% { opacity: 0.3; }
			50% { opacity: 1; }
			100% { opacity: 0.3; }
		}

		/* Animated dot traveling down */
		.flow-dot {
			width: 4px;
			height: 4px;
			border-radius: 50%;
			background: #ff073a;
			position: absolute;
			left: 50%;
			transform: translateX(-50%);
			animation: dotTravel 2s ease-in-out infinite;
			box-shadow: 0 0 6px rgba(255,7,58,0.6);
		}

		@keyframes dotTravel {
			0% { top: 0; opacity: 0; }
			20% { opacity: 1; }
			80% { opacity: 1; }
			100% { top: 100%; opacity: 0; }
		}

		/* ── Processing stages (anonymise, merge, output, alert) ── */
		.process-box {
			background: rgba(255,255,255,0.03);
			border: 1px solid rgba(255,255,255,0.08);
			border-radius: 8px;
			padding: 20px 24px;
			position: relative;
			overflow: hidden;
		}

		.process-box .box-header {
			display: flex;
			align-items: center;
			gap: 10px;
			margin-bottom: 10px;
		}

		.process-box .box-header .box-icon {
			width: 28px;
			height: 28px;
			opacity: 0.7;
			flex-shrink: 0;
		}

		.process-box .box-header .box-icon svg {
			width: 100%;
			height: 100%;
		}

		.process-box .box-title {
			font-size: 0.9rem;
			font-weight: 600;
			color: #fff;
			letter-spacing: 0.3px;
		}

		.process-box .box-desc {
			font-size: 0.72rem;
			color: rgba(255,255,255,0.45);
			line-height: 1.5;
		}

		/* ── Anonymisation animation ── */
		.anon-demo {
			display: flex;
			gap: 8px;
			margin-top: 14px;
			flex-wrap: wrap;
		}

		.anon-item {
			font-family: 'Courier New', monospace;
			font-size: 0.7rem;
			padding: 4px 10px;
			border-radius: 4px;
			background: rgba(255,255,255,0.06);
			color: rgba(255,255,255,0.6);
			position: relative;
			overflow: hidden;
		}

		.anon-item .anon-mask {
			position: absolute;
			inset: 0;
			background: rgba(255, 7, 58, 0.15);
			backdrop-filter: blur(4px);
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 0.6rem;
			color: #ff073a;
			letter-spacing: 1px;
			opacity: 0;
			animation: maskIn 4s ease-in-out infinite;
		}
		.anon-item:nth-child(2) .anon-mask { animation-delay: 0.5s; }
		.anon-item:nth-child(3) .anon-mask { animation-delay: 1s; }
		.anon-item:nth-child(4) .anon-mask { animation-delay: 1.5s; }

		@keyframes maskIn {
			0%, 30% { opacity: 0; }
			50%, 80% { opacity: 1; }
			100% { opacity: 0; }
		}

		/* ── Merge animation (converging streams) ── */
		.merge-visual {
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 6px;
			margin-top: 14px;
			height: 40px;
		}

		.merge-stream {
			width: 50px;
			height: 2px;
			border-radius: 1px;
			position: relative;
			overflow: hidden;
		}

		.merge-stream::after {
			content: '';
			position: absolute;
			top: 0;
			width: 16px;
			height: 100%;
			border-radius: 1px;
			animation: mergeFlow 2s ease-in-out infinite;
		}

		.merge-stream.left { background: rgba(100,150,255,0.15); }
		.merge-stream.left::after { left: -16px; background: rgba(100,150,255,0.6); animation-name: mergeFlowRight; }
		.merge-stream.center { background: rgba(255,150,100,0.15); }
		.merge-stream.center::after { left: -16px; background: rgba(255,150,100,0.6); animation-name: mergeFlowRight; animation-delay: 0.3s; }
		.merge-stream.right { background: rgba(150,255,100,0.15); }
		.merge-stream.right::after { right: -16px; background: rgba(150,255,100,0.6); animation-name: mergeFlowRight; animation-delay: 0.6s; }

		.merge-hub {
			width: 32px;
			height: 32px;
			border-radius: 50%;
			border: 1px solid rgba(255,7,58,0.3);
			display: flex;
			align-items: center;
			justify-content: center;
			font-family: 'Courier New', monospace;
			font-size: 0.55rem;
			color: #ff073a;
			letter-spacing: 0.5px;
			animation: hubPulse 2s ease-in-out infinite;
			flex-shrink: 0;
		}

		@keyframes mergeFlowRight {
			0% { transform: translateX(0); opacity: 0; }
			50% { opacity: 1; }
			100% { transform: translateX(50px); opacity: 0; }
		}

		@keyframes hubPulse {
			0%, 100% { box-shadow: 0 0 0 0 rgba(255,7,58,0); }
			50% { box-shadow: 0 0 12px 2px rgba(255,7,58,0.2); }
		}

		/* ── Transmission tree mini-viz ── */
		.tree-mini {
			margin-top: 14px;
			height: 56px;
			position: relative;
		}

		.tree-mini canvas {
			width: 100%;
			height: 100%;
		}

		/* ── Alert animation ── */
		.alert-demo {
			display: flex;
			align-items: center;
			gap: 12px;
			margin-top: 14px;
		}

		.alert-icon-anim {
			width: 32px;
			height: 32px;
			flex-shrink: 0;
			position: relative;
		}

		.alert-icon-anim svg {
			width: 100%;
			height: 100%;
		}

		.alert-icon-anim .alert-ring {
			position: absolute;
			inset: -4px;
			border-radius: 50%;
			border: 1px solid rgba(255,7,58,0.3);
			animation: alertRing 2s ease-out infinite;
		}

		.alert-icon-anim .alert-ring:nth-child(2) { animation-delay: 0.4s; }
		.alert-icon-anim .alert-ring:nth-child(3) { animation-delay: 0.8s; }

		@keyframes alertRing {
			0% { transform: scale(1); opacity: 0.6; }
			100% { transform: scale(1.8); opacity: 0; }
		}

		.alert-messages {
			display: flex;
			flex-direction: column;
			gap: 4px;
		}

		.alert-msg {
			font-family: 'Courier New', monospace;
			font-size: 0.65rem;
			color: rgba(255,255,255,0.5);
			padding: 3px 8px;
			background: rgba(255,7,58,0.06);
			border-left: 2px solid rgba(255,7,58,0.3);
			border-radius: 0 4px 4px 0;
			opacity: 0;
			animation: alertSlide 4s ease-in-out infinite;
		}
		.alert-msg:nth-child(2) { animation-delay: 1s; }
		.alert-msg:nth-child(3) { animation-delay: 2s; }

		@keyframes alertSlide {
			0%, 15% { opacity: 0; transform: translateX(-8px); }
			25%, 75% { opacity: 1; transform: translateX(0); }
			85%, 100% { opacity: 0; transform: translateX(4px); }
		}

		/* ── Responsive ── */
		@media (max-width: 980px) {
			#process {
				width: 40rem;
			}
		}

		@media (max-width: 736px) {
			#process {
				width: 100%;
			}
			.data-sources {
				grid-template-columns: 1fr;
				gap: 8px;
			}
			.source-card {
				padding: 14px 12px;
				display: flex;
				align-items: center;
				gap: 12px;
				text-align: left;
			}
			.source-card .source-icon {
				margin: 0;
				width: 28px;
				height: 28px;
			}
			.merge-visual {
				flex-wrap: wrap;
			}
		}
	</style>
</head>

<body class="is-preload">

	<canvas id="network-canvas"></canvas>

	<div id="wrapper">

		<header id="header">
			<div class="content">
				<div class="inner">
					<h1>NosoTrack</h1>
					<p>A Real-Time Platform for Nosocomial Outbreak Analytics </p>
				</div>
			</div>
			<nav>
				<ul>
					<li><a href="#about">About</a></li>
					<li><a href="#process">Process</a></li>
					<li><a href="#research">Research</a></li>
					<li><a href="#team">Team</a></li>
					<li><a href="#contact">Contact</a></li>
				</ul>
			</nav>
		</header>

		<div id="main">

			<article id="about">
				<h2 class="major">About</h2>
				<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 2rem;">
					<div
						style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 4px; text-align: center; border-bottom: 2px solid #ff073a;">
						<span style="display:block; font-size:0.7rem; color:#888; letter-spacing:1px;">CASES</span>
						<span style="font-size:1.5rem; font-weight:bold; color:#fff;">2.0M</span>
						<span style="display:block; font-size:0.65rem; color:#aaa; margin-top:4px;">US per year</span>
					</div>
					<div
						style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 4px; text-align: center; border-bottom: 2px solid #ff073a;">
						<span style="display: block; font-size: 0.7rem; color: #888; letter-spacing: 1px;">DEATHS</span>
						<span style="font-size: 1.5rem; font-weight: bold; color: #fff;">100K</span>
						<span style="display:block; font-size:0.65rem; color:#aaa; margin-top:4px;">US per year</span>
					</div>
					<div
						style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 4px; text-align: center; border-bottom: 2px solid #ff073a;">
						<span style="display: block; font-size: 0.7rem; color: #888; letter-spacing: 1px;">COST</span>
						<span style="font-size: 1.5rem; font-weight: bold; color: #fff;">$40B+</span>
						<span style="display:block; font-size:0.65rem; color:#aaa; margin-top:4px;">US per year</span>

					</div>
				</div>
				<p style="text-align: justify;">
					<b>Healthcare-associated infections (HAIs)</b> affect approximately 1 in 10 patients worldwide,
					causing significant morbidity, mortality, and economic strain on healthcare systems. <b>Nosocomial
						outbreaks</b>
					driven by person-to-person transmitted pathogens such as SARS-CoV-2, <em>Clostridioides
						difficile</em>, <em>Klebsiella pneumoniae</em>, and MRSA generate the most acute clinical and
					operational crises: triggering staff shortages, ward closures, and delayed procedures.
					Current control measures rely on broad testing and isolation protocols, but <b>effective
						intervention
						requires identifying the specific drivers of an outbreak</b>: such as patient zero,
					superspreaders, transmission routes, and undetected or imported cases. <br><br>
					<span
						style="color: red; font-weight: bold; font-family: Consolas, 'Courier New', Monaco, monospace; font-size: 24px;">
						NosoTrack
					</span>
					<b>is an outbreak
						analytics platform that infers who infected whom in near real-time</b> by integrating data from
					hospital Electronic Health Records with Bluetooth enabled contact tracing. It delivers early
					warnings
					and actionable reports, enabling hospital infection prevention teams to target interventions
					promptly before an outbreak escalates.
				</p>

				<div id="network-container"
					style="position: relative; width:100%; height:400px; border:1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.2); border-radius: 4px;">
					<div id="mynetwork" style="width:100%; height:100%;"></div>

					<div id="network-legend" style="
        position: absolute; 
        top: 15px; 
        left: 15px; 
        background: rgba(20, 20, 20, 0.8); 
        padding: 12px; 
        border-radius: 4px; 
        border: 1px solid rgba(255, 255, 255, 0.1); 
        font-family: monospace; 
        font-size: 11px; 
        color: #fff; 
        pointer-events: none;
        letter-spacing: 1px;
    ">
						<!-- TYPE Section -->
						<div
							style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.1);">
							<div style="font-weight: bold; margin-bottom: 8px; color: #aaa; font-size: 10px;">TYPE</div>
							<div style="display: flex; align-items: center; margin-bottom: 8px;">
								<div
									style="width: 10px; height: 10px; background: #888; border-radius: 50%; margin-right: 10px; box-shadow: 0 0 5px rgba(255,255,255,0.2);">
								</div>
								<span>PATIENT</span>
							</div>
							<div style="display: flex; align-items: center;">
								<div style="
                    width: 0; 
                    height: 0; 
                    border-left: 6px solid transparent; 
                    border-right: 6px solid transparent; 
                    border-bottom: 11px solid #888; 
                    margin-right: 9px;
                    filter: drop-shadow(0 0 3px rgba(255,255,255,0.2));
                "></div>
								<span>STAFF</span>
							</div>
						</div>

						<!-- WARD Section -->
						<div>
							<div style="font-weight: bold; margin-bottom: 8px; color: #aaa; font-size: 10px;">WARD</div>
							<div style="display: flex; align-items: center; margin-bottom: 6px;">
								<div
									style="width: 12px; height: 12px; background: rgba(100, 150, 255, 0.4); border: 1px solid rgba(100, 150, 255, 0.6); margin-right: 10px;">
								</div>
								<span>WARD A</span>
							</div>
							<div style="display: flex; align-items: center; margin-bottom: 6px;">
								<div
									style="width: 12px; height: 12px; background: rgba(255, 150, 100, 0.4); border: 1px solid rgba(255, 150, 100, 0.6); margin-right: 10px;">
								</div>
								<span>WARD B</span>
							</div>
							<div style="display: flex; align-items: center;">
								<div
									style="width: 12px; height: 12px; background: rgba(150, 255, 100, 0.4); border: 1px solid rgba(150, 255, 100, 0.6); margin-right: 10px;">
								</div>
								<span>WARD C</span>
							</div>
						</div>
					</div>
				</div>

			</article>

			<article id="process">
				<h2 class="major">Process</h2>

				<div class="pipeline">

					<!-- ── Stage 1: Data Sources ── -->
					<div class="pipeline-stage" data-stage="1">
						<div class="stage-label">Stage 1 — Data Sources</div>
						<div class="data-sources">

							<div class="source-card">
								<div class="source-icon">
									<svg viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M8 8h20v2H8z" fill="rgba(255,255,255,0.5)"/>
										<path d="M8 13h14v1.5H8z" fill="rgba(255,7,58,0.6)"/>
										<path d="M8 17h18v1.5H8z" fill="rgba(255,255,255,0.3)"/>
										<path d="M8 21h10v1.5H8z" fill="rgba(255,7,58,0.4)"/>
										<path d="M8 25h16v1.5H8z" fill="rgba(255,255,255,0.3)"/>
										<rect x="4" y="4" width="28" height="28" rx="3" stroke="rgba(255,255,255,0.2)" stroke-width="1" fill="none"/>
									</svg>
								</div>
								<div class="source-title">Sequencing</div>
								<div class="source-sub">DNA / test results</div>
							</div>

							<div class="source-card">
								<div class="source-icon">
									<svg viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
										<circle cx="12" cy="18" r="4" stroke="rgba(100,150,255,0.6)" stroke-width="1" fill="none"/>
										<circle cx="24" cy="14" r="3" stroke="rgba(255,150,100,0.6)" stroke-width="1" fill="none"/>
										<circle cx="22" cy="24" r="3.5" stroke="rgba(150,255,100,0.6)" stroke-width="1" fill="none"/>
										<line x1="15.5" y1="16.5" x2="21.5" y2="14.5" stroke="rgba(255,255,255,0.2)" stroke-width="0.8"/>
										<line x1="14.5" y1="21" x2="19.5" y2="23" stroke="rgba(255,255,255,0.2)" stroke-width="0.8"/>
										<line x1="24" y1="17" x2="23" y2="21" stroke="rgba(255,255,255,0.2)" stroke-width="0.8"/>
									</svg>
								</div>
								<div class="source-title">Contact Tracing</div>
								<div class="source-sub">Bluetooth proximity</div>
							</div>

							<div class="source-card">
								<div class="source-icon">
									<svg viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
										<rect x="5" y="6" width="26" height="24" rx="2" stroke="rgba(255,255,255,0.2)" stroke-width="1" fill="none"/>
										<line x1="5" y1="12" x2="31" y2="12" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
										<circle cx="10" cy="9" r="1.5" fill="rgba(255,7,58,0.5)"/>
										<circle cx="15" cy="9" r="1.5" fill="rgba(255,150,100,0.4)"/>
										<circle cx="20" cy="9" r="1.5" fill="rgba(150,255,100,0.4)"/>
										<path d="M9 16h8v1H9zM9 20h12v1H9zM9 24h6v1H9z" fill="rgba(255,255,255,0.25)"/>
										<path d="M22 16h5v9H22z" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="0.5" rx="1"/>
									</svg>
								</div>
								<div class="source-title">Health Records</div>
								<div class="source-sub">Electronic EHR data</div>
							</div>

						</div>
					</div>

					<!-- ── Flow: 3 → 1 converge ── -->
					<div class="flow-connector converge">
						<div class="flow-lines">
							<div class="flow-center-line"></div>
						</div>
						<div class="flow-dot"></div>
					</div>

					<!-- ── Stage 2: Data Anonymisation ── -->
					<div class="pipeline-stage" data-stage="2">
						<div class="stage-label">Stage 2 — Data Anonymisation</div>
						<div class="process-box">
							<div class="box-header">
								<div class="box-icon">
									<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
										<rect x="3" y="12" width="22" height="14" rx="2" stroke="rgba(255,255,255,0.4)" stroke-width="1" fill="none"/>
										<path d="M8 12V8a6 6 0 0 1 12 0v4" stroke="rgba(255,255,255,0.3)" stroke-width="1" fill="none"/>
										<circle cx="14" cy="19" r="2" fill="rgba(255,7,58,0.5)"/>
										<line x1="14" y1="21" x2="14" y2="24" stroke="rgba(255,7,58,0.4)" stroke-width="1"/>
									</svg>
								</div>
								<div class="box-title">Identifiers Removed & Encrypted</div>
							</div>
							<div class="box-desc">Patient names, dates of birth, and direct identifiers are stripped or encrypted before analysis.</div>
							<div class="anon-demo">
								<div class="anon-item">
									Name: J. Smith
									<div class="anon-mask">REDACTED</div>
								</div>
								<div class="anon-item">
									DOB: 1985-03-12
									<div class="anon-mask">HASHED</div>
								</div>
								<div class="anon-item">
									MRN: 4827301
									<div class="anon-mask">ENCRYPTED</div>
								</div>
								<div class="anon-item">
									Ward: B
									<div class="anon-mask">KEPT</div>
								</div>
							</div>
						</div>
					</div>

					<!-- ── Flow: single ── -->
					<div class="flow-connector single">
						<div class="flow-lines"></div>
						<div class="flow-dot"></div>
					</div>

					<!-- ── Stage 3: Data Merging ── -->
					<div class="pipeline-stage" data-stage="3">
						<div class="stage-label">Stage 3 — Data Integration</div>
						<div class="process-box">
							<div class="box-header">
								<div class="box-icon">
									<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M4 8h8v12H4z" fill="rgba(100,150,255,0.1)" stroke="rgba(100,150,255,0.3)" stroke-width="0.8" rx="2"/>
										<path d="M10 10h8v12h-8z" fill="rgba(255,150,100,0.1)" stroke="rgba(255,150,100,0.3)" stroke-width="0.8" rx="2"/>
										<path d="M16 6h8v12h-8z" fill="rgba(150,255,100,0.1)" stroke="rgba(150,255,100,0.3)" stroke-width="0.8" rx="2"/>
										<path d="M12 14l4-2v6l-4-2z" fill="rgba(255,7,58,0.4)"/>
									</svg>
								</div>
								<div class="box-title">Streams Converge into NosoTrack</div>
							</div>
							<div class="box-desc">Genomic, contact, and clinical data are linked and merged into a unified analytical model.</div>
							<div class="merge-visual">
								<div class="merge-stream left"></div>
								<div class="merge-stream center"></div>
								<div class="merge-stream right"></div>
								<div class="merge-hub">NT</div>
								<div class="merge-stream left" style="transform: scaleX(-1);"></div>
							</div>
						</div>
					</div>

					<!-- ── Flow: single ── -->
					<div class="flow-connector single">
						<div class="flow-lines"></div>
						<div class="flow-dot"></div>
					</div>

					<!-- ── Stage 4: Transmission Tree ── -->
					<div class="pipeline-stage" data-stage="4">
						<div class="stage-label">Stage 4 — Transmission Tree</div>
						<div class="process-box">
							<div class="box-header">
								<div class="box-icon">
									<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
										<circle cx="14" cy="4" r="2.5" fill="rgba(255,7,58,0.6)"/>
										<circle cx="7" cy="14" r="2" fill="rgba(255,7,58,0.4)"/>
										<circle cx="21" cy="12" r="2" fill="rgba(255,7,58,0.4)"/>
										<circle cx="4" cy="23" r="1.8" fill="rgba(255,7,58,0.3)"/>
										<circle cx="11" cy="22" r="1.8" fill="rgba(255,7,58,0.3)"/>
										<circle cx="18" cy="22" r="1.8" fill="rgba(255,7,58,0.3)"/>
										<circle cx="25" cy="20" r="1.8" fill="rgba(255,7,58,0.3)"/>
										<line x1="14" y1="6.5" x2="7" y2="12" stroke="rgba(255,255,255,0.2)" stroke-width="0.8"/>
										<line x1="14" y1="6.5" x2="21" y2="10" stroke="rgba(255,255,255,0.2)" stroke-width="0.8"/>
										<line x1="7" y1="16" x2="4" y2="21" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
										<line x1="7" y1="16" x2="11" y2="20" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
										<line x1="21" y1="14" x2="18" y2="20" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
										<line x1="21" y1="14" x2="25" y2="18" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
									</svg>
								</div>
								<div class="box-title">Who Infected Whom</div>
							</div>
							<div class="box-desc">The merged data produces a transmission tree: a directed graph of inferred infection events across wards.</div>
							<div class="tree-mini">
								<canvas id="mini-tree-canvas"></canvas>
							</div>
						</div>
					</div>

					<!-- ── Flow: single ── -->
					<div class="flow-connector single">
						<div class="flow-lines"></div>
						<div class="flow-dot"></div>
					</div>

					<!-- ── Stage 5: Early Warning ── -->
					<div class="pipeline-stage" data-stage="5">
						<div class="stage-label">Stage 5 — Early Warning System</div>
						<div class="process-box">
							<div class="box-header">
								<div class="box-icon">
									<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M14 3l12 20H2L14 3z" stroke="rgba(255,7,58,0.5)" stroke-width="1" fill="rgba(255,7,58,0.08)"/>
										<line x1="14" y1="10" x2="14" y2="17" stroke="rgba(255,7,58,0.6)" stroke-width="1.5"/>
										<circle cx="14" cy="20" r="1" fill="rgba(255,7,58,0.6)"/>
									</svg>
								</div>
								<div class="box-title">Automated Alerts & Reports</div>
							</div>
							<div class="box-desc">Infection prevention teams receive real-time notifications when a potential outbreak is detected.</div>
							<div class="alert-demo">
								<div class="alert-icon-anim">
									<svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M6 22V12a10 10 0 0 1 20 0v10l3 4H3l3-4z" stroke="rgba(255,7,58,0.5)" stroke-width="1" fill="rgba(255,7,58,0.08)"/>
										<circle cx="16" cy="29" r="2.5" fill="rgba(255,7,58,0.3)"/>
									</svg>
									<div class="alert-ring"></div>
									<div class="alert-ring"></div>
									<div class="alert-ring"></div>
								</div>
								<div class="alert-messages">
									<div class="alert-msg">ALERT: Cluster detected — Ward B (3 cases, 48h)</div>
									<div class="alert-msg">NOTIFY: IPC team — superspreader flagged (S3)</div>
									<div class="alert-msg">REPORT: Transmission tree updated — 12 nodes</div>
								</div>
							</div>
						</div>
					</div>

				</div>
			</article>

			<article id="research">
				<h2 class="major">Research</h2>
				<p style="text-align: justify;">
					Novel computational methods that reconstruct who infected whom from clinical, contact, and
					genetic data have proven effective in guiding outbreak control across pathogens such as SARS-CoV-2,
					influenza, Ebola, and antimicrobial-resistant bacteria

					Yet, they remain largely retrospective, with no integration into routine hospital surveillance. What
					is lacking is an automated system capable of deploying these models in near real-time:
					this is the aim of <span style="color: #ff073a; font-weight: bold;">NosoTrack</span>.
				</p>

				<h3>Selected publications and software</h3>

				<div class="pub-grid">

					<a class="pub-card" href="https://pubmed.ncbi.nlm.nih.gov/35215195/" target="_blank">
						<span class="pub-tag">Paper</span>
						<div class="pub-title">Literature review</div>
						<div class="pub-desc">A systematic review of outbreak reconstruction methods.</div>
					</a>

					<a class="pub-card" href="https://link.springer.com/article/10.1186/s12859-018-2330-z"
						target="_blank">
						<span class="pub-tag">Paper</span>
						<div class="pub-title">A modular platform for outbreak reconstruction</div>
						<div class="pub-desc">The paper for outbreaker2.</div>
					</a>

					<a class="pub-card" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0313037"
						target="_blank">
						<span class="pub-tag">Paper</span>
						<div class="pub-title">linktree</div>
						<div class="pub-desc">A method to infer transmission patterns between staff and patients.</div>
					</a>

					<a class="pub-card" href="https://pubmed.ncbi.nlm.nih.gov/40302215/" target="_blank">
						<span class="pub-tag">Paper</span>
						<div class="pub-title">Real time genomic surveillance for nosocomial outbreaks</div>
						<div class="pub-desc">Proof of concept for near real time surveillance.</div>
					</a>

					<a class="pub-card" href="https://github.com/reconhub/outbreaker2" target="_blank">
						<span class="pub-tag">Software</span>
						<div class="pub-title">outbreaker2</div>
						<div class="pub-desc">Software to reconstruct transmission trees.</div>
					</a>

					<a class="pub-card" href="https://cygei.github.io/o2ools/index.html" target="_blank">
						<span class="pub-tag">Software</span>
						<div class="pub-title">o2ools</div>
						<div class="pub-desc">Software to analyse transmission trees.</div>
					</a>

				</div>

			</article>

			<article id="team">
				<h2 class="major">Team</h2>

				<!-- Cyril -->
				<div style="display:flex; align-items:flex-start; margin-bottom:20px; flex-wrap: wrap;">
					<img src="images/cyril.jpg" alt="Dr Cyril Geismar"
						style="width:150px; border-radius:10%; margin-right:15px; margin-bottom:10px;">
					<p style="text-align: justify; flex:1;">
						<span style="color: #ff073a; font-weight: bold;">Dr Cyril Geismar</span> is a postdoctoral
						research fellow at Johns Hopkins University. He earned his PhD in the mathematical modelling of
						infectious diseases at Imperial College London, where his research focused on developing methods
						and software for SARS-CoV-2 outbreak reconstruction. He serves on the executive board and
						contributes as a software developer for the <a href="https://www.repidemicsconsortium.org/"
							target="_blank">R Epidemics Consortium</a> and teaches outbreak analytics at <a
							href="https://sismid.sph.emory.edu/online-modules/recon-tools/index.html"
							target="_blank">Emory University</a> and <a
							href="https://data.org/our-work/epiverse/training-africa/course/" target="_blank">the London
							School of Hygiene & Tropical Medicine</a>.
					</p>
				</div>

				<!-- Thibaut Jombart -->
				<div style="display:flex; align-items:flex-start; margin-bottom:20px; flex-wrap: wrap;">
					<img src="images/thibaut.jpg" alt="Dr Thibaut Jombart"
						style="width:150px; border-radius:10%; margin-right:15px; margin-bottom:10px;">
					<p style="text-align: justify; flex:1;">
						<span style="color: #ff073a; font-weight: bold;">Dr Thibaut Jombart</span> is a Senior Lecturer
						at Imperial College London specialising in outbreak response analytics, with expertise in
						biostatistics, population genetics, and R programming. He is the lead author of <a
							href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003457"
							target="_blank">outbreaker</a> and
						founder of the <a href="https://www.repidemicsconsortium.org/" target="_blank">R Epidemics
							Consortium</a>. He has field experience in outbreak response, including Ebola deployments in
						the Democratic Republic of the Congo.
					</p>
				</div>

				<!-- Anne Cori -->
				<div style="display:flex; align-items:flex-start; margin-bottom:20px; flex-wrap: wrap;">
					<img src="images/anne.jpg" alt="Dr Anne Cori"
						style="width:150px; border-radius:10%; margin-right:15px; margin-bottom:10px;">
					<p style="text-align: justify; flex:1;">
						<span style="color: #ff073a; font-weight: bold;">Dr Anne Cori</span> is a Senior Lecturer at
						Imperial
						College London specialising in real-time outbreak analysis and estimation of epidemiological
						parameters. She
						is the lead author of <a href="https://academic.oup.com/aje/article/178/9/1505/89262"
							target="_blank">EpiEstim</a> and co-author of <a
							href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003457"
							target="_blank">outbreaker</a>. Her
						research develops statistical methods for outbreak
						reconstruction
						and rapid assessment of transmissibility, integrating epidemiological and genomic data to inform
						control
						strategies.
					</p>
				</div>

				<!-- Shaun Truelove -->
				<div style="display:flex; align-items:flex-start; margin-bottom:20px; flex-wrap: wrap;">
					<img src="images/shaun.jpg" alt="Dr Shaun Truelove"
						style="width:150px; border-radius:10%; margin-right:15px; margin-bottom:10px;">
					<p style="text-align: justify; flex:1;">
						<span style="color: #ff073a; font-weight: bold;">Dr Shaun Truelove</span> is an Associate
						Professor at Johns Hopkins University. His
						work focuses on applying infectious disease dynamics
						and modelling to inform public health response, and policy, particularly for
						COVID-19, influenza, and vaccine-preventable diseases.
						He co-leads the <a href="https://scenariomodelinghub.org/" target="_blank">US Scenario Modeling
							Hubs</a> and <a href="https://insightnet.us/centers/accidda/" target="_blank">ACCIDA</a>, a
						consortium of
						researchers producing epidemic scenario projections and forecasts.
					</p>
				</div>


			</article>



			<article id="contact">
				<h2 class="major">Contact</h2>
				<p>
					We are actively seeking collaborations and funding. Please reach out!
				</p>
				<form method="POST" action="https://formspree.io/f/maqdqzqw">
					<div class="fields">
						<div class="field half">
							<label for="name">Name</label>
							<input type="text" name="name" id="name" />
						</div>
						<div class="field half">
							<label for="email">Email</label>
							<input type="text" name="email" id="email" />
						</div>
						<div class="field">
							<label for="message">Message</label>
							<textarea name="message" id="message" rows="4"></textarea>
						</div>
					</div>
					<ul class="actions">
						<li><input type="submit" value="Send Message" class="primary" /></li>
						<li><input type="reset" value="Reset" /></li>
					</ul>
				</form>
				<ul class="icons">
					<li><a href="https://github.com/CyGei" class="icon brands fa-github"><span
								class="label">GitHub</span></a></li>
				</ul>
			</article>

		</div>

		<footer id="footer">
			<p class="copyright">&copy; Cyril Geismar.</p>
		</footer>

	</div>

	<div id="bg"></div>

	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<script>
		(function () {
			const canvas = document.getElementById('network-canvas');
			const ctx = canvas.getContext('2d');
			let width, height;
			let particles = [];

			// CONFIGURATION
			const particleCount = 110;       // Denser network
			const connectionDistance = 140;  // How close to draw lines
			const infectionDistance = 140;   // Infection transmission range (same as lines)
			const particleSpeed = 0.6;       // Speed of movement

			// VISUALS
			const healthyColor = 'rgba(200, 200, 200, 0.6)'; // Grey
			const infectedColor = 'rgba(255, 50, 50, 0.9)';  // Red
			const healthyLine = '200, 200, 200';
			const infectedLine = '255, 50, 50';

			// INFECTION LOGIC
			const infectionChance = 0.02;    // Chance to infect per frame per contact (2%)
			const recoveryTime = 600;        // Frames until recovery (approx 10 seconds @ 60fps)

			// Resize handling
			function resize() {
				width = canvas.width = window.innerWidth;
				height = canvas.height = window.innerHeight;
			}
			window.addEventListener('resize', resize);
			resize();

			// Particle Class
			class Particle {
				constructor() {
					this.x = Math.random() * width;
					this.y = Math.random() * height;
					this.vx = (Math.random() - 0.5) * particleSpeed;
					this.vy = (Math.random() - 0.5) * particleSpeed;
					this.size = Math.random() * 2 + 1;

					this.isInfected = false;
					this.infectionTimer = 0;
				}

				infect() {
					if (!this.isInfected) {
						this.isInfected = true;
						this.infectionTimer = recoveryTime;
					}
				}

				update() {
					// Move
					this.x += this.vx;
					this.y += this.vy;

					// Bounce off edges
					if (this.x < 0 || this.x > width) this.vx *= -1;
					if (this.y < 0 || this.y > height) this.vy *= -1;

					// Handle Infection Timer
					if (this.isInfected) {
						this.infectionTimer--;
						if (this.infectionTimer <= 0) {
							this.isInfected = false; // Recover
						}
					}
				}

				draw() {
					ctx.fillStyle = this.isInfected ? infectedColor : healthyColor;
					ctx.beginPath();
					ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
					ctx.fill();
				}
			}

			// Initialize particles
			function initParticles() {
				particles = [];
				for (let i = 0; i < particleCount; i++) {
					let p = new Particle();
					// Randomly infect a few "Patient Zeros"
					if (Math.random() < 0.05) {
						p.infect();
					}
					particles.push(p);
				}
			}
			initParticles();

			// Animation Loop
			function animate() {
				ctx.clearRect(0, 0, width, height);

				// Re-ignite infection if everyone recovers
				if (!particles.some(p => p.isInfected)) {
					// Pick a random lucky winner to restart the outbreak
					particles[Math.floor(Math.random() * particles.length)].infect();
				}

				for (let i = 0; i < particles.length; i++) {
					particles[i].update();
					particles[i].draw();

					// Check connections
					for (let j = i; j < particles.length; j++) {
						const dx = particles[i].x - particles[j].x;
						const dy = particles[i].y - particles[j].y;
						const distance = Math.sqrt(dx * dx + dy * dy);

						if (distance < connectionDistance) {
							// Infection Spread Logic
							if (particles[i].isInfected && !particles[j].isInfected) {
								if (Math.random() < infectionChance) particles[j].infect();
							} else if (!particles[i].isInfected && particles[j].isInfected) {
								if (Math.random() < infectionChance) particles[i].infect();
							}

							// Draw Line
							ctx.beginPath();
							const opacity = 1 - (distance / connectionDistance);

							// If either is infected, line is red
							if (particles[i].isInfected || particles[j].isInfected) {
								ctx.strokeStyle = `rgba(${infectedLine}, ${opacity})`;
							} else {
								ctx.strokeStyle = `rgba(${healthyLine}, ${opacity * 0.5})`; // Fainter lines for healthy
							}

							ctx.lineWidth = 1;
							ctx.moveTo(particles[i].x, particles[i].y);
							ctx.lineTo(particles[j].x, particles[j].y);
							ctx.stroke();
						}
					}
				}
				requestAnimationFrame(animate);
			}
			animate();
		})();
	</script>

	<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
	<script>
		(function () {
			const container = document.getElementById('mynetwork');

			const COLORS = {
				healthy: '#444444',
				infected: '#ff073a',
				superspreader: '#ff0000',
				healthyBorder: '#666666',
				text: '#ffffff',
				edge: 'rgba(255, 255, 255, 0.15)',
				wardA: 'rgba(100, 150, 255, 0.2)',
				wardB: 'rgba(255, 150, 100, 0.2)',
				wardC: 'rgba(150, 255, 100, 0.2)',
				wardABorder: 'rgba(100, 150, 255, 0.5)',
				wardBBorder: 'rgba(255, 150, 100, 0.5)',
				wardCBorder: 'rgba(150, 255, 100, 0.5)'
			};

			// Ward boundaries (square boxes)
			const WARDS = {
				A: { xCenter: -400, yBase: 0, width: 300, label: 'Ward A', color: COLORS.wardA, borderColor: COLORS.wardABorder },
				B: { xCenter: 0, yBase: 0, width: 300, label: 'Ward B', color: COLORS.wardB, borderColor: COLORS.wardBBorder },
				C: { xCenter: 400, yBase: 0, width: 300, label: 'Ward C', color: COLORS.wardC, borderColor: COLORS.wardCBorder }
			};

			// Helper function to add small random noise to y-coordinate
			const noise = (baseY) => baseY + (Math.random() - 0.5) * 40;

			// Helper to position node within ward bounds
			const wardPos = (ward, yBase, xOffset = 0) => ({
				x: WARDS[ward].xCenter + xOffset + (Math.random() - 0.5) * 80,
				y: WARDS[ward].yBase + yBase + noise(0)
			});

			// Node assignments to wards
			const nodeData = [
				{ id: 1, label: 'P0', ward: 'A', y: 0, xOffset: 0 },
				{ id: 2, label: 'S1', ward: 'A', y: 70, xOffset: 50 },
				{ id: 3, label: 'S2', ward: 'B', y: 50, xOffset: 0 },
				{ id: 4, label: 'P3', ward: 'A', y: 200, xOffset: 50 },
				{ id: 5, label: 'P4', ward: 'A', y: 180, xOffset: 80 },
				{ id: 6, label: 'P5', ward: 'B', y: 150, xOffset: -50 },
				{ id: 7, label: 'P6', ward: 'B', y: 200, xOffset: 50 },
				{ id: 8, label: 'P7', ward: 'C', y: 200, xOffset: 0 },
				{ id: 10, label: 'S3', ward: 'B', y: 250, xOffset: 0 },
				// Generation 4: Superspreader burst
				{ id: 9, label: 'P2', ward: 'A', y: 320, xOffset: 0 },
				{ id: 11, label: 'S4', ward: 'A', y: 400, xOffset: 60 },
				{ id: 12, label: 'P10', ward: 'B', y: 400, xOffset: -70 },
				{ id: 13, label: 'S5', ward: 'B', y: 500, xOffset: 0 },
				{ id: 14, label: 'P12', ward: 'B', y: 450, xOffset: 80 },
				{ id: 15, label: 'P13', ward: 'B', y: 400, xOffset: 30 },
				{ id: 16, label: 'S6', ward: 'C', y: 400, xOffset: -40 },
				{ id: 18, label: 'S7', ward: 'C', y: 300, xOffset: 50 },
				// Later generations
				{ id: 19, label: 'P17', ward: 'C', y: 500, xOffset: 60 },
				{ id: 20, label: 'P18', ward: 'C', y: 550, xOffset: -70 },
				{ id: 21, label: 'S8', ward: 'A', y: 400, xOffset: -30 },
				{ id: 17, label: 'P15', ward: 'C', y: 520, xOffset: 20 },
				{ id: 22, label: 'P20', ward: 'A', y: 510, xOffset: 40 },
				{ id: 23, label: 'P21', ward: 'A', y: 510, xOffset: -50 }
			];

			// Create nodes with ward-based positioning
			const nodes = new vis.DataSet(
				nodeData.map(n => {
					const pos = wardPos(n.ward, n.y, n.xOffset);
					const isStaff = n.label.startsWith('S');
					return {
						id: n.id,
						label: n.label,
						shape: isStaff ? 'triangle' : 'dot',
						size: (n.id === 10) ? 40 : 25,
						x: pos.x,
						y: pos.y,
						ward: n.ward
					};
				})
			);

			const edges = new vis.DataSet([
				// Generation 0 → Generation 1
				{ id: 'e1', from: 1, to: 2 },
				{ id: 'e2', from: 1, to: 3 },

				// Generation 1 → Generation 2
				{ id: 'e3', from: 2, to: 4 },
				{ id: 'e4', from: 2, to: 5 },
				{ id: 'e5', from: 3, to: 6 },
				{ id: 'e6', from: 3, to: 7 },
				{ id: 'e7', from: 3, to: 8 },

				// Generation 2 → Generation 3 (Superspreader)
				{ id: 'e8', from: 6, to: 10 },

				// Generation 3 → Generation 4 (Superspreader burst)
				{ id: 's1', from: 10, to: 9 },
				{ id: 's2', from: 10, to: 11 },
				{ id: 's3', from: 10, to: 12 },
				{ id: 's4', from: 10, to: 13 },
				{ id: 's5', from: 10, to: 14 },
				{ id: 's6', from: 10, to: 15 },
				{ id: 's7', from: 10, to: 16 },
				{ id: 's8', from: 10, to: 18 },

				// Generation 4 → Generation 5+
				{ id: 'e9', from: 18, to: 19 },
				{ id: 'e10', from: 18, to: 20 },
				{ id: 'e11', from: 9, to: 21 },
				{ id: 'e12', from: 21, to: 22 },
				{ id: 'e13', from: 21, to: 23 },
				{ id: 'e14', from: 16, to: 17 }
			]);

			const options = {
				layout: {
					hierarchical: {
						enabled: false
					}
				},
				physics: { enabled: false },
				edges: {
					arrows: { to: { enabled: true, scaleFactor: 0.8 } },
					color: { color: COLORS.edge, opacity: 0.3 },
					width: 1.5,
					smooth: { type: 'cubicBezier', roundness: 0.4 }
				},
				nodes: {
					font: { color: COLORS.text, face: 'monospace', size: 20, vadjust: -35 },
					borderWidth: 2,
					color: { background: COLORS.healthy, border: COLORS.healthyBorder }
				},
				interaction: { dragNodes: true, zoomView: true, dragView: true }
			};

			const network = new vis.Network(container, { nodes, edges }, options);

			// Draw ward boxes after network is initialized
			network.on('afterDrawing', function (ctx) {
				// Draw ward boxes (extended vertically)
				Object.values(WARDS).forEach(ward => {
					const halfWidth = ward.width / 2;

					// Convert network coordinates to canvas coordinates
					const topLeft = network.canvasToDOM({ x: ward.xCenter - halfWidth, y: -100 });
					const bottomRight = network.canvasToDOM({ x: ward.xCenter + halfWidth, y: 800 });

					const canvasTopLeft = network.DOMtoCanvas(topLeft);
					const canvasBottomRight = network.DOMtoCanvas(bottomRight);

					// Draw ward box
					ctx.strokeStyle = ward.borderColor;
					ctx.fillStyle = ward.color;
					ctx.lineWidth = 2;

					const boxX = canvasTopLeft.x;
					const boxY = canvasTopLeft.y;
					const boxWidth = canvasBottomRight.x - canvasTopLeft.x;
					const boxHeight = canvasBottomRight.y - canvasTopLeft.y;

					ctx.fillRect(boxX, boxY, boxWidth, boxHeight);
					ctx.strokeRect(boxX, boxY, boxWidth, boxHeight);
				});
			});

			// Fit the network to view after a short delay
			setTimeout(() => network.fit(), 100);

			const observer = new ResizeObserver(() => { network.fit(); });
			observer.observe(container);

			let infectedIds = new Set();
			const SUPERSPREADER_ID = 10;

			function runSimulation() {
				nodes.forEach(n => nodes.update({ id: n.id, color: { background: COLORS.healthy, border: COLORS.healthyBorder }, shadow: false }));
				edges.forEach(e => edges.update({ id: e.id, color: COLORS.edge, width: 1.5 }));
				infectedIds.clear();

				infectNode(1, null);

				const spreadInterval = setInterval(() => {
					let targets = [];

					infectedIds.forEach(id => {
						const downstream = edges.get({ filter: (e) => e.from === id });
						downstream.forEach(edge => {
							if (!infectedIds.has(edge.to)) {
								targets.push({ nodeId: edge.to, edgeId: edge.id, sourceId: id });
							}
						});
					});

					if (targets.length > 0) {
						const superspreaderTargets = targets.filter(t => t.sourceId === SUPERSPREADER_ID);
						if (superspreaderTargets.length > 0 && infectedIds.has(SUPERSPREADER_ID)) {
							superspreaderTargets.forEach(t => infectNode(t.nodeId, t.edgeId));
						} else {
							const t = targets[Math.floor(Math.random() * targets.length)];
							infectNode(t.nodeId, t.edgeId);
						}
					} else {
						clearInterval(spreadInterval);
						setTimeout(runSimulation, 5000);
					}
				}, 800);
			}

			function infectNode(nodeId, edgeId) {
				infectedIds.add(nodeId);
				const isSuperspreader = (nodeId === SUPERSPREADER_ID);

				nodes.update({
					id: nodeId,
					color: { background: COLORS.infected, border: '#ffffff' },
					shadow: {
						enabled: true,
						color: COLORS.infected,
						size: isSuperspreader ? 35 : 12,
						x: 0, y: 0
					}
				});

				if (edgeId) edges.update({ id: edgeId, color: COLORS.infected, width: 3 });
			}

			runSimulation();
		})();
	</script>

	<!-- Process Pipeline Animations -->
	<script>
		(function () {
			// ── Intersection Observer for stage reveal ──
			const stages = document.querySelectorAll('.pipeline-stage');

			const revealObserver = new IntersectionObserver((entries) => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						entry.target.classList.add('visible');
					}
				});
			}, { threshold: 0.15 });

			stages.forEach(s => revealObserver.observe(s));

			// Also trigger when the Process article becomes active
			const processArticle = document.getElementById('process');
			if (processArticle) {
				const articleObserver = new MutationObserver(() => {
					if (processArticle.classList.contains('active')) {
						// Small delay to let the article transition start
						setTimeout(() => {
							stages.forEach((s, i) => {
								setTimeout(() => s.classList.add('visible'), i * 200);
							});
							drawMiniTree();
						}, 150);
					} else {
						stages.forEach(s => s.classList.remove('visible'));
					}
				});
				articleObserver.observe(processArticle, { attributes: true, attributeFilter: ['class'] });
			}

			// ── Mini Transmission Tree Canvas (Stage 4) ──
			function drawMiniTree() {
				const canvas = document.getElementById('mini-tree-canvas');
				if (!canvas) return;

				const rect = canvas.parentElement.getBoundingClientRect();
				canvas.width = rect.width * 2;
				canvas.height = rect.height * 2;
				canvas.style.width = rect.width + 'px';
				canvas.style.height = rect.height + 'px';

				const ctx = canvas.getContext('2d');
				ctx.scale(2, 2);

				const w = rect.width;
				const h = rect.height;

				// Tree nodes: { x, y, r, gen }
				const treeNodes = [
					{ x: w * 0.5, y: 6, r: 4, gen: 0 },
					{ x: w * 0.28, y: 18, r: 3.5, gen: 1 },
					{ x: w * 0.68, y: 16, r: 3.5, gen: 1 },
					{ x: w * 0.14, y: 30, r: 3, gen: 2 },
					{ x: w * 0.32, y: 32, r: 3, gen: 2 },
					{ x: w * 0.55, y: 28, r: 3, gen: 2 },
					{ x: w * 0.78, y: 30, r: 3, gen: 2 },
					{ x: w * 0.08, y: 44, r: 2.5, gen: 3 },
					{ x: w * 0.2, y: 42, r: 2.5, gen: 3 },
					{ x: w * 0.38, y: 46, r: 2.5, gen: 3 },
					{ x: w * 0.52, y: 42, r: 2.5, gen: 3 },
					{ x: w * 0.65, y: 44, r: 2.5, gen: 3 },
					{ x: w * 0.82, y: 46, r: 2.5, gen: 3 },
					{ x: w * 0.92, y: 42, r: 2.5, gen: 3 },
				];

				const treeEdges = [
					[0, 1], [0, 2],
					[1, 3], [1, 4],
					[2, 5], [2, 6],
					[3, 7], [3, 8],
					[4, 9],
					[5, 10], [5, 11],
					[6, 12], [6, 13],
				];

				let infectedSet = new Set();
				let step = 0;

				function animateTree() {
					ctx.clearRect(0, 0, w, h);

					// Draw edges
					treeEdges.forEach(([from, to]) => {
						const a = treeNodes[from];
						const b = treeNodes[to];
						const isActive = infectedSet.has(from) && infectedSet.has(to);
						ctx.beginPath();
						ctx.moveTo(a.x, a.y);
						ctx.lineTo(b.x, b.y);
						ctx.strokeStyle = isActive ? 'rgba(255, 7, 58, 0.5)' : 'rgba(255, 255, 255, 0.08)';
						ctx.lineWidth = isActive ? 1.2 : 0.6;
						ctx.stroke();
					});

					// Draw nodes
					treeNodes.forEach((n, i) => {
						ctx.beginPath();
						ctx.arc(n.x, n.y, n.r, 0, Math.PI * 2);
						if (infectedSet.has(i)) {
							ctx.fillStyle = 'rgba(255, 7, 58, 0.7)';
							ctx.shadowColor = 'rgba(255, 7, 58, 0.4)';
							ctx.shadowBlur = 6;
						} else {
							ctx.fillStyle = 'rgba(255, 255, 255, 0.12)';
							ctx.shadowColor = 'transparent';
							ctx.shadowBlur = 0;
						}
						ctx.fill();
						ctx.shadowBlur = 0;
					});

					// Spread infection by generation
					const gen = Math.floor(step / 30);
					treeNodes.forEach((n, i) => {
						if (n.gen <= gen) infectedSet.add(i);
					});

					step++;
					if (step > 180) {
						step = 0;
						infectedSet.clear();
					}

					if (processArticle && processArticle.classList.contains('active')) {
						requestAnimationFrame(animateTree);
					}
				}

				animateTree();
			}

			// Handle resize for mini tree
			let resizeTimer;
			window.addEventListener('resize', () => {
				clearTimeout(resizeTimer);
				resizeTimer = setTimeout(drawMiniTree, 200);
			});
		})();
	</script>
</body>

</html>